apiVersion: infra.contrib.fluxcd.io/v1alpha1
kind: Terraform
metadata:
  labels:
    templates.weave.works/template-name: rds-template
    templates.weave.works/template-namespace: default
  name: rds-database-demo
  namespace: devteam1
  annotations:
    templates.weave.works/create-request: "{\"repository_url\":\"https://github.com/weavegitops/podinfo-app.git\",\"head_branch\":\"wge-create-branch-d1ctim\",\"title\":\"Create resource \",\"description\":\"This PR creates a rds-template instance\",\"template_name\":\"rds-template\",\"parameter_values\":{\"BACKUP_RETENTION_PERIOD\":\"1\",\"CLUSTER_IDENTIFIER\":\"rdsdatabasedemo\",\"DATABASE_ENGINE\":\"aurora-mysql\",\"DATABASE_ENGINE_VERSION\":\"5.7.mysql_aurora.2.11.1\",\"DATABASE_INSTANCE_SIZE\":\"db.t3.small\",\"DATABASE_NAME\":\"rdsdatabasedemo\",\"DESTROY\":\"false\",\"REGION\":\"eu-central-1\",\"RESOURCE_NAME\":\"rds-database-demo\"},\"commit_message\":\"Create rds-template instance\",\"credentials\":{},\"template_namespace\":\"devteam1\",\"template_kind\":\"GitOpsTemplate\"}"
    templates.weave.works/created-files: "{\"files\":[\"clusters/management/terraform/devteam1/rds-database-demo.yaml\"]}"
spec:
  alwaysCleanupRunnerPod: true
  approvePlan: auto
  destroy: false
  destroyResourcesOnDeletion: true
  enableInventory: true
  interval: 1h
  path: ./terraform/rds
  sourceRef:
    kind: GitRepository
    name: flux-system
    namespace: flux-system
  storeReadablePlan: human
  vars:
  - name: cluster_identifier
    value: rdsdatabasedemo
  - name: database_name
    value: rdsdatabasedemo
  - name: backup_retention_period
    value: 1
  - name: region
    value: eu-central-1
  - name: database_engine
    value: aurora-mysql
  - name: database_engine_version
    value: 5.7.mysql_aurora.2.11.1
  - name: database_instance_size
    value: db.t3.small
  varsFrom:
  - kind: Secret
    name: tf-controller-auth
  - kind: Secret
    name: rds-db-creds
